<VirtualHost *:80>
    ServerName nike.fr.gl3
    Redirect permanent / https://nike.fr.gl3
</VirtualHost>

<VirtualHost *:443>
    ServerName nike.fr.gl3
    ServerAlias niketest.fr.gl3

    SSLEngine on
    SSLCertificateFile /usr/lib/ngw/https/nike.crt
    SSLCertificateKeyFile /usr/lib/ngw/https/nike.key
    
    DBDriver pgsql
    DBDParams "host=localhost dbname=ngw user=XXXXXXXX password=XXXXXXXX"

    DocumentRoot "/usr/lib/ngw/static"
    AddDefaultCharset UTF-8
    PythonPath "['/usr/lib'] + sys.path"

    Alias /media/ /usr/share/python-support/python-django/django/contrib/admin/media/

    <LocationMatch "^/$">
        SetHandler python-program
        PythonHandler django.core.handlers.modpython
        SetEnv DJANGO_SETTINGS_MODULE ngw.settings
        PythonDebug On
        PythonAutoReload On
    </LocationMatch>
    <Location "/contacts/">
        SetHandler python-program
        PythonHandler django.core.handlers.modpython
        SetEnv DJANGO_SETTINGS_MODULE ngw.settings
        PythonDebug On
        PythonAutoReload On
    </Location>
    <Location "/contactgroups/">
        SetHandler python-program
        PythonHandler django.core.handlers.modpython
        SetEnv DJANGO_SETTINGS_MODULE ngw.settings
        PythonDebug On
        PythonAutoReload On
    </Location>
    <Location "/contactfields/">
        SetHandler python-program
        PythonHandler django.core.handlers.modpython
        SetEnv DJANGO_SETTINGS_MODULE ngw.settings
        PythonDebug On
        PythonAutoReload On
    </Location>
    <Location "/choicegroups/">
        SetHandler python-program
        PythonHandler django.core.handlers.modpython
        SetEnv DJANGO_SETTINGS_MODULE ngw.settings
        PythonDebug On
        PythonAutoReload On
    </Location>
    <LocationMatch "/test$">
        SetHandler python-program
        PythonHandler django.core.handlers.modpython
        SetEnv DJANGO_SETTINGS_MODULE ngw.settings
        PythonDebug On
        PythonAutoReload On
        
        AuthType Basic
        AuthName "ngw"
        AuthBasicProvider dbd

        Require valid-user

        AuthDBDUserPWQuery "SELECT passwd FROM contact WHERE login = %s"
    </LocationMatch>
</VirtualHost>


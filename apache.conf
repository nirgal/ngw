<VirtualHost *:80>
    ServerName nike.fr.gl3
    Redirect permanent / https://nike.fr.gl3
</VirtualHost>

<VirtualHost *:443>
    ServerName nike.fr.gl3
    ServerAlias niketest.fr.gl3

    SSLEngine on
    SSLCertificateFile /usr/lib/ngw/https/nike.crt
    SSLCertificateKeyFile /usr/lib/ngw/https/nike.key
    
    DBDriver pgsql
    DBDParams "host=localhost dbname=ngw user= password="

    DocumentRoot "/usr/lib/ngw/static"
    AddDefaultCharset UTF-8
    ServerSignature Off
    CustomLog "/dev/null" " "
    ErrorLog "/usr/lib/ngw/apache_error.log"

    PythonPath "['/usr/lib'] + sys.path"

    Alias /media/ /usr/share/python-support/python-django/django/contrib/admin/media/

    <Location "/">
        AuthType Basic
        # TODO: AuthType Digest require another password encryption scheme
        AuthName "ngw"
        AuthBasicProvider dbd
        #AuthDigestProvider dbd
        AuthDBDUserPWQuery "SELECT passwd FROM contact WHERE login = %s"
        # The following line is used for "AuthType Digest" where the real is part of the md5 hash
        #AuthDBDUserRealmQuery "SELECT passwd FROM contact WHERE login = %s"
        #AuthDigestDomain https://nike.fr.gl3 https://niketest.fr.gl3 http://nike.fr.gl3 http://niketest.fr.gl3
        Require valid-user
    </Location>

    <LocationMatch "^/logout$">
        SetHandler python-program
        PythonHandler django.core.handlers.modpython
        SetEnv DJANGO_SETTINGS_MODULE ngw.settings
        PythonDebug On
        PythonAutoReload On
        Satisfy Any
    </LocationMatch>
    <LocationMatch "^/$">
        SetHandler python-program
        PythonHandler django.core.handlers.modpython
        SetEnv DJANGO_SETTINGS_MODULE ngw.settings
        PythonDebug On
        PythonAutoReload On
    </LocationMatch>
    <Location "/contacts/">
        SetHandler python-program
        PythonHandler django.core.handlers.modpython
        SetEnv DJANGO_SETTINGS_MODULE ngw.settings
        PythonDebug On
        PythonAutoReload On
    </Location>
    <Location "/contactgroups/">
        SetHandler python-program
        PythonHandler django.core.handlers.modpython
        SetEnv DJANGO_SETTINGS_MODULE ngw.settings
        PythonDebug On
        PythonAutoReload On
    </Location>
    <Location "/contactfields/">
        SetHandler python-program
        PythonHandler django.core.handlers.modpython
        SetEnv DJANGO_SETTINGS_MODULE ngw.settings
        PythonDebug On
        PythonAutoReload On
    </Location>
    <Location "/choicegroups/">
        SetHandler python-program
        PythonHandler django.core.handlers.modpython
        SetEnv DJANGO_SETTINGS_MODULE ngw.settings
        PythonDebug On
        PythonAutoReload On
    </Location>
    <LocationMatch "^/test$">
        SetHandler python-program
        PythonHandler django.core.handlers.modpython
        SetEnv DJANGO_SETTINGS_MODULE ngw.settings
        PythonDebug On
        PythonAutoReload On
    </LocationMatch>
</VirtualHost>


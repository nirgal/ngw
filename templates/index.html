{% extends "base.html" %}
{% load ngwtags %}

{% block body %}
<script src="{{MEDIA_URL}}/ngw.js"></script>

{% if user.is_admin %}
<div class=box>
    Welcome {{ user }}!
    <br>There are {{ ncontacts }} contacts in the database.
    
    <p>
    <form id=realform action="/contacts/"><input type=hidden name=filter value=""></form>
    <form id=displayedform action="#" onsubmit="javascript:document.forms['realform']['filter'].value='nfilter(startswith,'+escape_quote(document.forms['displayedform']['filter'].value)+')'; document.forms['realform'].submit(); return false;">
    Quick contact search: <input name=filter id=defaultfocus>
    </form>
    <script>document.forms['displayedform'].filter.focus();</script>
</div>
{% endif %}

{% for g in operator_groups %}
{% if forloop.first %}
    <h1 class="boxheader">You are operator of theses groups:</h1>
    <div class=box>
{% endif %}
‣ <a href="{{g.get_absolute_url}}">{{ g.unicode_with_date }}</a><br>
{% if forloop.last %}
    </div>
{% endif %}
{% endfor %}

<h1 class="boxheader">Please select an operation:</h1>
<div id=submitbar style="margin-top:0px;">
<a href="contacts/{{user.id}}/">My information</a>
{% if user.is_admin %}
<a href="contactgroups/">Contact Groups</a>
<a href="contacts/">All contacts</a>
<a href="contactfields/">Setup of optional fields</a>
<a href="choicegroups/">Setup of choice lists</a>
<a href="logs?_order=-0">Logs</a>
{% endif %}
</div>

{% if user.is_admin %}
<h1 class="boxheader">Derniers développements</h1>
<div class=box>
{% for article in news %}
<b>{{ article.date|date:"D d M Y" }}</b><br>
{{ article.text|autobr|safe }}<br><br>
{% endfor %}
<a href="/contactgroups/8/news/">Toutes les news...</a>
</div>
{% endif %}

{% endblock %}
